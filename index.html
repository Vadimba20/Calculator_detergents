<!doctype html>
<html lang="ru">
<head>
  <!-- ... остальная часть head ... -->
  <style>
    /* ... существующие стили ... */
    
    .validation-error {
      border: 1px solid #e53935 !important;
    }
    
    .tooltip {
      position: relative;
      display: inline-block;
      border-bottom: 1px dotted #ccc;
      cursor: help;
    }
    
    .tooltip .tooltiptext {
      visibility: hidden;
      width: 200px;
      background-color: #555;
      color: #fff;
      text-align: center;
      border-radius: 6px;
      padding: 5px;
      position: absolute;
      z-index: 1;
      bottom: 125%;
      left: 50%;
      margin-left: -100px;
      opacity: 0;
      transition: opacity 0.3s;
      font-size: 12px;
    }
    
    .tooltip:hover .tooltiptext {
      visibility: visible;
      opacity: 1;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <!-- ... существующий header ... -->
    </header>

    <main>
      <!-- left column: inputs -->
      <section class="card">
        <div class="section-title">Общие параметры</div>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px">
          <div>
            <label id="labelLoad">Загрузка машины (кг)</label>
            <input id="machineLoad" type="number" min="1" value="10" />
          </div>
          <div>
            <label id="labelTariff">Тариф электроэнергии (₽/кВт·ч)</label>
            <input id="energyTariff" type="number" min="0" step="0.01" value="6.5" />
          </div>
        </div>

        <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-top:10px">
          <div>
            <label id="labelWork">Рабочих часов в день</label>
            <input id="workHours" type="number" min="1" value="9" />
          </div>
          <div>
            <label>Тариф воды (₽/м³) <span class="tooltip">ℹ<span class="tooltiptext">Стоимость одного кубометра воды</span></span></label>
            <input id="waterTariff" type="number" min="0" step="0.01" value="45" />
          </div>
        </div>

        <hr style="margin:12px 0;border:none;border-top:1px solid #eef6ff" />

        <div class="section-title">Текущие моющие средства</div>
        <!-- ... существующая таблица ... -->
        
        <hr style="margin:12px 0;border:none;border-top:1px solid #eef6ff" />

        <div class="section-title">Наши новые средства</div>
        <!-- ... существующая таблица ... -->

      </section>

      <!-- right column: program params + results -->
      <section>
        <div class="card">
          <div class="section-title">Параметры программ</div>
          <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:8px">
            <div>
              <label id="labelOldTemp">Температура текущей программы (°C)</label>
              <input id="oldTemp" type="number" min="0" value="60" />
            </div>
            <div>
              <label id="labelOldTime">Время текущей программы (мин)</label>
              <input id="oldTime" type="number" min="1" value="60" />
            </div>
            <div>
              <label id="labelNewTemp">Температура новой программы (°C)</label>
              <input id="newTemp" type="number" min="0" value="40" />
            </div>
            <div>
              <label id="labelNewTime">Время новой программы (мин)</label>
              <input id="newTime" type="number" min="1" value="45" />
            </div>
          </div>
          
          <div style="margin-top:10px">
            <label>Мощность стиральной машины (кВт) <span class="tooltip">ℹ<span class="tooltiptext">Указана в технических характеристиках машины</span></span></label>
            <input id="machinePower" type="number" min="0.1" step="0.1" value="2.5" />
          </div>

          <div style="display:flex;gap:8px;align-items:center;margin-top:10px">
            <button class="btn" id="calcBtn">Рассчитать</button>
            <button class="btn ghost" id="resetBtn">Сбросить всё</button>
            <div style="margin-left:auto;color:var(--muted);font-size:13px">Автосохранение: включено</div>
          </div>
        </div>

        <div class="card" style="margin-top:12px">
          <div class="section-title">Результаты</div>
          
          <div class="results-grid">
            <!-- ... существующие результаты ... -->
            <div class="stat"><h4>Экономия воды на 1 кг</h4><p id="savingWater">— ₽</p></div>
          </div>
          
          <!-- ... остальная часть результатов ... -->
        </div>
      </section>
    </main>
    
    <footer>
      <div>Один файл: <strong>index.html</strong> — работает локально и на GitHub Pages / Netlify.</div>
    </footer>
  </div>

  <script>
    // ... существующий код ...
    
    // Расширенное состояние
    let state = {
      // ... существующие поля ...
      oldTemp: 60,
      waterTariff: 45,
      machinePower: 2.5,
      // ... остальные поля ...
    }
    
    // Улучшенная функция расчета энергии
    function energyKWh(temp, timeMin, power) {
      const heatingPower = power * 0.8; // 80% мощности на нагрев
      const motorPower = power * 0.2;   // 20% мощности на двигатель
      
      const heatingTime = Math.min(30, timeMin * 0.5); // предположим, нагрев занимает 50% времени, но не более 30 мин
      const motorTime = timeMin;
      
      const heatingEnergy = (heatingPower * heatingTime / 60) * (temp / 80); // учитываем температуру
      const motorEnergy = motorPower * motorTime / 60;
      
      return heatingEnergy + motorEnergy;
    }
    
    // Функция расчета стоимости воды
    function waterCost(temp, timeMin, tariff, machineLoad) {
      // Базовый расход воды (литры) в зависимости от температуры и времени
      const baseWaterConsumption = 10 + (temp / 10) + (timeMin / 10);
      const waterCost = (baseWaterConsumption * tariff / 1000) / machineLoad; // переводим в м³ и на кг
      return waterCost;
    }
    
    // ... остальной код с интеграцией улучшений ...
  </script>
</body>
</html>
